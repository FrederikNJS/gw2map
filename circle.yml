general:
  branches:
    ignore:
      - gh-pages

machine:
  node:
    version: 5.4.1

checkout:
  post:
    - git config --global user.name "CircleCI"
    - git config --global user.email circleci@circleci.com
    - git merge -s ours -m "Automated Merge" origin/gh-pages
    - git checkout gh-pages

dependencies:
  cache_directories:
    - "jspm_packages"
    - "node_modules"
  override:
    - npm install -g http-server jspm
    - npm isntall
    - jspm install
    - jspm bundle --inject --minify javascript/gw2map.js javascript/bundle.js

deployment:
  gh-pages:
    branch: master
    commands:
      - git commit -m "Automated Build"
      - git push origin gh-pages
